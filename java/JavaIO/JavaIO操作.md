[TOC]

# Java I/O æ“ä½œ

Java.io åŒ…é‡Œé¢çš„éƒ½æ˜¯é˜»å¡çš„ IO. å³ä¸º BIO 

ä¹Ÿå°±è¯´, åˆ©ç”¨è¿™ä¸ªåŒ…è¯»å–çš„æ—¶å€™ **çº¿ç¨‹ä¸ºé˜»å¡çš„**

## æŒ‰æµæ•°æ®ç»“æ„åˆ’åˆ†

* å­—èŠ‚æµ : InputStream, outputStream
* å­—ç¬¦æµ : Read , Write

å¯¹äº **Java.io** çš„æ“ä½œé‡Œé¢æ¥è¯´, **è¾“å…¥æµ å’Œ è¾“å‡ºæµ å¼åˆ†å¼€çš„**.



## æŒ‰æµç±»å‹åˆ’åˆ† 

* èŠ‚ç‚¹æµ : ä»ä¸€ä¸ªç‰¹å®šçš„æ–‡ä»¶è¿›è¡Œè¯»å–
* è¿‡æ»¤æµ : ä½¿ç”¨èŠ‚ç‚¹æµä½œä¸º è¾“å…¥æˆ–è¾“å‡º, è¿‡æ»¤æµæ˜¯ä½¿ç”¨ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ è¾“å…¥, è¾“å‡ºæµåˆ›å»ºçš„ **e.g. StringBuffer å…¶å®å°±æ˜¯åˆ©ç”¨äº†è£…é¥°è€…æ¨¡å¼**





# Java IO æŒ‰è¯»å†™ç»“æ„åˆ’åˆ†

* å­—èŠ‚æµ : InputStream, outputStream
* å­—ç¬¦æµ : Read , Write

å­—èŠ‚æµ + ç¼–ç è¡¨ = å­—ç¬¦æµ

åŠ **å­—èŠ‚æµæ˜¯ä¸æ¶‰åŠç¼–ç è¡¨çš„**, å°†å­—èŠ‚å¯¹åº”åˆ°å¯¹åº”çš„ç è¡¨ä¸­, ä¾¿æˆäº†å­—ç¬¦æµ

![img](https://www.runoob.com/wp-content/uploads/2013/12/iostream2xx.png)







# å­—ç¬¦æµ



# ä¸€. åŸºæœ¬è¯»å†™ç±»

* FileWriter
* FileReader



## FileWrite ç±»

**FileWrite å¯¹è±¡å†™å…¥å­—ç¬¦çš„æ­¥éª¤**

~~~java
/*
	åˆ›å»ºä¸€ä¸ªå†™æ–‡ä»¶å¯¹è±¡
	å¦‚æœä¸å­˜åœ¨è¯¥æ–‡ä»¶, é‚£ä¹ˆè¯¥æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ª test.txtæ–‡ä»¶
	æ³¨æ„, Javaè¯»å†™ç±» ä¸ä»…å¯ä»¥è¯»å†™ .txt æ–‡ä»¶
	è¿˜å¯ä»¥è¯»å†™ .csv æ–‡ä»¶ æ“ä½œå’Œ .txt æ–‡ä»¶ä¸€è‡´
*/
String dir = "test.txt";
FileWriter fw = new FileWriter(dir);


/*
	å†™å…¥æ–‡ä»¶å¯¹è±¡
	æ³¨æ„æ­¤æ—¶åªæ˜¯å†™å…¥æ–‡ä»¶çš„ç¼“å†²åŒº, 
	å¹¶æ²¡æœ‰çœŸæ­£çš„å†™å…¥æ–‡ä»¶ä¸­
*/
fw.write("hello world");
fw.write();
...
    
/*
	åˆ·æ–°ç¼“å†²åŒº, æ•°æ®è¢«å†™å…¥ç£ç›˜
*/
fw.flush();


/*
	å…³é—­ I/O èµ„æº
*/
fw.close()
~~~



<hr>
**å†™å…¥æ–‡ä»¶çš„ç›¸å…³ç»†èŠ‚**

~~~java
/*
	1. å…³äºæ¢è¡Œç¬¦
	   åœ¨ Linux ä¸‹, ç³»ç»Ÿæ¢è¡Œä¸º \n
	   åœ¨ Win ä¸‹, æ¢è¡Œä¸º \r\n
	   æ‰€ä»¥ä¸ºäº†å¯ç§»æ¤æ€§, æˆ‘ä»¬é‡‡å– : 
	   new_line å¯ä»¥æ ¹æ®ä¸åŒçš„ç³»ç»Ÿ, è¿”å›ä¸åŒçš„æ¢è¡Œç¬¦
*/
private static final String new_line = System.getProperty("line.separator");


/*
	2. æ–‡ä»¶ è¿½åŠ æ¨¡å¼
	   å¦åˆ™è¦†ç›– æ–‡ä»¶çš„åŸæ¥çš„å†…å®¹
	   åœ¨æ–‡ä»¶åé¢åŠ ä¸€ä¸ª true å³å¯
*/
FileWrite fw = new FileWrite(dir, true);
~~~





## å†™æ–‡ä»¶ I/O å¼‚å¸¸æœºåˆ¶

å‡ ä¹æ‰€æœ‰çš„ I/O æ“ä½œéƒ½æœ‰å¼‚å¸¸æœºåˆ¶

~~~java
/*
	è¯»æ–‡ä»¶ try-catch æ ¼å¼
*/
FileWriter fw = null;

try{
    fw = new FileWriter(dir);
    fw.wirte();
    ...
}catch(IOException e){
    
    // æ–‡ä»¶ä¸å­˜åœ¨ ...
    
}finally{
    if(fw != null){
        try{
            fw.close();
        }catch(IOException e){
            //  æ–‡ä»¶èµ„æºå…³é—­å¤±è´¥ ...
        }   
    }
}

~~~



## FileReader ç±»

FileReader æ˜¯ä¸€ä¸ª æ–‡ä»¶è¯»å–ç±»



**æŒ‰å­—ç¬¦è¯»å–**

~~~java
/*
	åˆ›å»ºä¸€ä¸ªè¯»æ–‡ä»¶å¯¹è±¡
*/
String url = "test.txt";
FileReader fr = new FileReader(url)
    
/*
	int read();
	æ³¨æ„ read() è¿”å›å€¼ä¸ºint ç±»å‹çš„
*/
int ch = fr.read();

/*
	fr.read() è¯»å–ä¸€æ¬¡ä»¥å
	æ–‡ä»¶è¯»å–æŒ‡é’ˆ è‡ªåŠ¨ æŒ‡å‘ä¸‹ä¸€ä¸ªå­—ç¬¦
	æ‰€ä»¥æˆ‘ä»¬è¿ç»­è¯»å°±è¡Œäº†, ä¸éœ€è¦æ‰‹åŠ¨ç§»åŠ¨ è¯»å–æŒ‡é’ˆ
*/
int ch2 = fr.read();

/*
	å½“æ–‡ä»¶åˆ°ç»“å°¾çš„æ—¶å€™, read() è¿”å› -1
	æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨whileè¯»å–
*/
int ch;
while((ch = fr.read())!= -1){
    System.out.println(ch)
}
~~~



<hr>
**æŒ‰ char æ•°ç»„çš„å½¢å¼è¯»å–**

~~~java
FileReader fr = new FileReader(url);

/*
	1. å…ˆåˆ›å»ºä¸€ä¸ª char[] æ•°ç»„
*/
char[] buffer = new char[100];

/*
	2. å°†æ•°ç»„å­˜å‚¨äº buffer æ•°ç»„
	   int read(buffer); 
	   æ³¨æ„çš„è¿”å›å€¼ä¹Ÿæ˜¯ int ç±»å‹çš„, ä½†æ˜¯è¡¨ç¤ºçš„æ˜¯ è¯»å–çš„æœ‰æ•ˆå­—ç¬¦çš„é•¿åº¦
*/
fr.read(buffer);

/*
	3. ä¸”è¯»å–ä¸€æ¬¡ä¹‹å, æ–‡ä»¶çš„æŒ‡é’ˆä¹Ÿä¼šç§»åŠ¨ char[].length() ä¸ªå•ä½
	   ğŸŒŸ å¦‚æœæ­¤æ¬¡ ä¸€ä¸ªæœ‰æ•ˆå­—ç¬¦éƒ½æ²¡æœ‰è¯»å–åˆ°, é‚£ä¹ˆè¿”å› -1
	   ä¹Ÿå°±æ˜¯è¯´, å‡è®¾æ•°ç»„é•¿åº¦ä¸º 100, é‚£ä¹ˆ æ–‡ä»¶å³ä½¿æœ‰ä¸€ä¸ªæ•°æ®, é‚£ä¹ˆè¿”å›å€¼ä¸º 1
*/

/*
	4. å°† char[] æ•°ç»„ è½¬åŒ–ä¸º String è¾“å‡º
*/
System.out.println(new String(buffer));
~~~



**åˆ©ç”¨ While çš„æ–¹å¼è¯»å–**

~~~java
int len = 1024;
char[] ch = new char[len];

int read_len = 0;
FileReader fr = new FileReader(url);

// -1 ä»ç„¶æ˜¯æ–‡ä»¶å°¾çš„åˆ¤æ–­æ ‡å¿—
while ((read_len = fr.read(ch)) != -1){
    System.out.println(new String(ch, 0, read_len));
}
~~~





# äºŒ. ç¼“å†²è¯»å†™ç±»

åŠ å…¥è¯»å†™ ç¼“å†²åŒº å¯ä»¥ **å¤§å¤§çš„æé«˜æ•ˆç‡**, å…ˆæŠŠ è¯»/å†™ çš„å†…å®¹æ”¾åœ¨ç¼“å†²åŒºé‡Œé¢, å†é›†ä¸­çš„è¿›è¡Œ I/O æ“ä½œ, å¯ä»¥æ£€æŸ¥ I/O æ“ä½œæ¬¡æ•°, æé«˜æ•ˆç‡

ç¼“å†²åŒºçš„ä¸¤ä¸ªç±», åˆ©ç”¨äº† **è£…é¥°è€…** çš„è®¾è®¡æ¨¡å¼

ç¼“å†²åŒºç±» åˆ†ä¸ºä»¥ä¸‹å‡ ç±» : 

* BufferedReader
* BufferedWriter



##BufferedWriter ç±» 

å®é™…ä¸Š , BufferedWriter å¹¶æ²¡æœ‰è°ƒç”¨ç³»ç»Ÿèµ„æº.

æœ¬è´¨ä¸Šè¿˜æ˜¯ **åˆ©ç”¨ BufferedWriter æ“ä½œäº† FileWriter å¯¹è±¡**

æ‰€ä»¥ åœ¨æ„é€ æ—¶, éœ€è¦å°† FileWriter ä¼ å…¥

ç»“æŸæ—¶, å°±æ˜¯å…³é—­çš„ FileWriter å¯¹è±¡

~~~java
/*
	åŠ å…¥ å­—ç¬¦æµç¼“å†²åŒº
	æé«˜å†™æ–‡ä»¶æ•ˆç‡
	
	
	è¿˜æ˜¯è¦å…ˆåˆ›å»ºä¸€ä¸ª FileWriter å¯¹è±¡ !!!
*/
FileWriter fw = new FileWriter(url);

/*
	åˆ©ç”¨ FileWriter ä½œä¸º BufferedWriter æ„é€ å‡½æ•°ä¼ å‚, æ„é€ å‡º BufferedWriter
	åˆ›å»ºä¸€ä¸ªå­—ç¬¦æµçš„ç¼“å†²åŒºçš„å¯¹è±¡, å¹¶å’ŒæŒ‡å®šçš„ç¼“å†²åŒºæµå¯¹è±¡å…³è”
*/
BufferedWriter bw = new BufferedWriter(fw);

/*
	ä¸‹é¢ç›´æ¥ç”¨ ç¼“å†²åŒºå¯¹è±¡çš„æ–¹æ³• è¿›è¡Œå†™å…¥æ“ä½œ
	ä»è€Œæ›¿ä»£ FileWriter äº†æ‰€æœ‰æ“ä½œ
*/
bw.write("hello buffer");

/*
	BufferedWriter å¯¹è±¡ å°è£…äº† å¹³å°æ— å…³çš„ æ¢è¡Œç¬¦å¯¹è±¡
	bw.newline();
*/
bw.wirte("hello" + bw.newline())

/*
	åˆ·æ–° ç¼“å†²åŒº
*/
bw.flush();

/*
	ç¼“å†²åŒºå…³äº†ä¹‹å, fw ä¾¿ä¸éœ€è¦æ‰§è¡Œ close() äº†
	å…¶å® ç¼“å†²åŒºå…³é—­ å°±æ˜¯ æµå¯¹è±¡å…³é—­
*/
bw.close();
~~~



## BufferedReader ç±»

åˆ©ç”¨ç¼“å†²åŒº è¯»åŒºæ•°æ®

~~~java
FileReader fr = new FileRead(url)

/*
	ç¼“å†²åŒº æ„é€ å‡½æ•°è¿˜æ˜¯è¦å…ˆä¼ å…¥ FileReader å¯¹è±¡
*/
BufferedReader bf = new BufferedReader(fr);
    

/*
	ç¼“å†²ä¼˜åŒ–çš„ç‰¹æœ‰æ–‡æœ¬è¯»å–æ–¹æ³•
	è¯»å–æ–‡æœ¬çš„ä¸€è¡Œ
	String readLine();
	å¦‚æœåˆ°è¾¾æ–‡æœ¬çš„åœ°æ­¥, é‚£ä¹ˆè¿”å› null ğŸŒŸ
*/
String line;
while((line = bf.readLine()) != null){
    Sys.o.p (line);
}

fr.close();
~~~





# å­—èŠ‚æµ

* åŸºæœ¬æ“ä½œå’Œå­—ç¬¦æµç›¸åŒ
* å¯ä»¥æ“ä½œå„ç§å¯¹è±¡, ä¸ä»…å­—ç¬¦å¯¹è±¡, åŒ…æ‹¬å„ç§åª’ä½“èµ„æº, ç­‰ç­‰

# ä¸€. åŸºæœ¬è¯»å†™ç±»


## FileOutputStream å¯¹è±¡

~~~java
/*
	å­—èŠ‚æµå†™å…¥çš„æ—¶å€™, ä¸éœ€è¦è¿›è¡Œ ç¼–è§£ç 
	ä¸éœ€è¦å¯¹è¿›è¡Œ flush
*/
FileOutputStream fos = new FileOutputStream(url);

// å°†å­—ç¬¦ä¸²å¦†æ¢ä¸º å­—èŠ‚ç 
fos.write("hello world".getBytes());

// å…³é—­èµ„æº
fos.close()
~~~







## FileInputStream å¯¹è±¡

~~~java
FileInputStream fis = new FileInputStream(url);

// ä¸€ä¸ª å­—èŠ‚ ä¸€ä¸ªå­—èŠ‚çš„ è¯»å–
int len = fis.red()

// å…³é—­èµ„æº
fis.close()
~~~



























