[TOC]

# VIM

Vim/Vi 是一个强大的全屏幕文本编辑器, 可以建立,编辑,显示文本. 最重要是可以在Linux上不下载编辑器,而直接方便的进行文本代码编辑.

**Vim/Vi没有菜单, 只有命令**







## vim/vi 的工作模式

* 命令模式	 
* 插入模式 
* 编辑模式

在缺省的状态下, 默认进入的是**命令模式**

~~~shell
#表示用vi编辑filename
$vi filename
~~~

在命令模式下, 可以键入不同的命令

在该模式下可以进入**插入模式 ,和编辑模式, 但是插入模式和编辑模式不能相互转化**

在命令模式下,输入 i a o ... 可以进入**插入模式**

插入模式下可以对文本进行编辑 , 按 ESC 键便可以返回 **命令模式**

在命令模式下,输入 :(冒号) 可以进入**编辑模式** , 编辑模式可以设定一些关于编辑文本的参数,比如设置行号..

在编辑模式下,命令以回车结束,结束后会退回 **命令模式**

在命令模式下, 输入 **:wq** 即为保存退出

## 命令

### 插入命令

|   命令    |         作用         |
| :-------: | :------------------: |
| a(append) |   在光标后附加文本   |
|     A     |  在本行行末附加文本  |
| i(insert) |   在光标前插入文本   |
|     I     | 在本行的开始插入文本 |
|     o     |   在光标下插入新行   |
|     O     |   在光标上插入新行   |



### 定位命令

|    命令    |             作用             |
| :--------: | :--------------------------: |
| h:方向左键 |           光标左移           |
| j:方向下键 |           下移一行           |
| k:方向上键 |           上移一行           |
| l:方向右键 |           光标右移           |
|     $      |           移至行尾           |
|     0      |           移至行首           |
|     H      |  移至屏幕上端(并不是第一行)  |
|     M      |         移至屏幕中央         |
|     L      | 移至屏幕下端(并不是最后一行) |
|  :set nu   |           设置行号           |
| : set nonu |           取消行号           |
|     nG     |           到第n行            |
|     :n     |           到第n行            |
|     gg     |           到第一行           |
|     G      |          到最后一行          |



### 删除命令

|  命令   |               作用               |
| :-----: | :------------------------------: |
|    x    |        删除光标所在处字符        |
|   nx    |     删除光标坐在处后n个字符      |
|   dd    |    删除光标所在行, ndd删除n行    |
|   dG    | 删除光标所在行到(文件)末尾的内容 |
|    D    |       删除从光标所在处到行       |
| :n1,n2d |         删除指定范围的行         |



###复制和剪切命令

|  命令  |             作用             |
| :----: | :--------------------------: |
|  yy,Y  |         复制当前的行         |
| nyy,nY |       复制当前以下n行        |
|   dd   |          剪切当前行          |
|  ndd   |      剪切当前行以下n行       |
|  p,P   | 粘贴在当前光标所在行下或行上 |



### 替换和取消命令

|    命令    |                作用                |
| :--------: | :--------------------------------: |
| r(replace) |         取代光标所在处字符         |
|     R      | 从光标所在处看是替换字符,按Esc结束 |
|     u      |           取消上一步操作           |



### 搜索和替换命令

| 命令                          | 作用                                                         |
| ----------------------------- | ------------------------------------------------------------ |
| /string                       | 在整个文本中搜索指定的字符串, 搜索时忽略大小写 :set ic       |
| n(next)                       | 搜索指定的字符串的下一个出现位置                             |
| :%s/old_str/new_str/g         | 全文中将old_str替换为new_str                                 |
| :n1,n2s/old_str/new_str/g (c) | 在n1<= row <= n2的行范围内, 将old_str替换为new_str . 且选项为g则不询问是否替换, 如果为c则在替换前会进行询问 |





### 退出命令

* 命令模式下 **:wq** 即为保存退出
* 命令模式下 ZZ (两大写的z也为退出)
* 注意在只读权限下, 也可以用**root**和**所有者**进行编辑(w), 在退出的时候输入  **:wq!** 即可
* 不保存退出 **:q!**
* 保存不退出且另存为 **:w tmp/backup**





### 应用操作

* 在该文件中, 导入另外一个文件 **:r another_file** (将another_file中导入正在编辑的光标处)

* 在vi中使用命令 **:!ls -l** (则可以在vi模式下使用命令)

* 可以将第一个 与 第二个结合起来用, 即将**命令输出的结果**导入到编辑的文件中 e.g **r !date**(将当前的时间导入到文本中)

* 定义快捷键 **:map 快捷键 触发命令**

  ~~~shell
  #^P 为一个快捷键 (并不为尖角号加p)而是(ctrl + v + P) 实现了 ctrl+p 的快捷键
  #I为在该行的行首插入文本
  # #为所需插入的字符
  # <ESC>为插入完之后 默认按 ESC 从而进入命令模式
  :map ^P I#<ESC>
  
  #表示在当前光标前插入的邮箱
  :map ^E i522500442@qq.cpm
  
  #去掉该行的井号
  # 0为跳到该行首, x为删除当前光标字符
  :map ^B 0x
  ~~~

* 连续行的注释

  ~~~shell
  #表示将 n1 <= row <= n2行的行首,加上#号
  #在vi中 ^(尖角号) 默认表示的为行首
  :n1,n2s/^/#/g
  #表示将 n1<= row <= n2行的注释去掉
  :n1,n2s/#//g
  
  #有些语言并不是#为i注释, 而为 // 此时需要使用转移符号 \
  :n1,n2s/^/\/\//g
  ~~~

* 替换命令

  :ab str1 str2 此时在vi文本编辑模式下, 输出str1+space会自动被替换为str2

  ```shell
  #在文本编辑状态在 输入mymail 可以自动替换为 522500442@qq.com
  :ab mymail 522500442@qq.com
  #取消替换命令
  :unab mymail
  ```
















