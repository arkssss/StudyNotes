

## Linux进程管理

### 进程和程序

* 进程 : 是一个动态的概念, 是一个程序动态执行的过程
* 程序 : 是一个静态的概念, 本身作为一个软件资源长期保存

* 两者并不是一一对应的关系, 进程的运行中可以对应很多程序, **一个程序也可以对应很多进程**

### 前台进程和后台进程

* 前台进程 : 在Shell 提示符打入命令之后, 创建一个子进程, shell 等待命令退出之后退出. 此命令与Shell异步运行, 即只有当此进程运行完之后, 用户才能输入吓一跳命令

* 后台进程 : 可以在Shell打入的命令, 若后面加一个 & , shell 创建的子进程运行此命令, 不需要等待这条命令的完成, 而是转而到后台去运行. 注意此种方式必须为非交互式的. 

  ~~~shell
  find / -name init > /test/init.find &
  ~~~

### 进程状态

**大致分为三种状态**

* 就绪 : 获得了除了CPU之外的所有系统资源, 只等待此时的CPU分配时间片便可以运行了.
* 等待 : 还在等待除了CPU时间片外其他的需要的资源
* 运行 : 正在CPU上运行的状态



### linux 中涉及到进程管理的命令



####w命令(比who给出的信息更多)

~~~shell
//列出所有登陆的用户信息
# w
~~~

列出的各个信息的含义

| USER       | TTY        | FROM   | LOGING                       | IDLE           | JCPU                  | PCPU                | WHAT               |
| ---------- | ---------- | ------ | ---------------------------- | -------------- | --------------------- | ------------------- | ------------------ |
| 登陆的用户 | 登陆的终端 | ip地址 | 系统过去一段时间的平均负载值 | 用户闲置的时间 | 这个终端占用的cpu时间 | CPU执行程耗费的时间 | 用户正在执行的操作 |

#### ps命令

* 每个用户使用系统都应该有一个终端

~~~~shell
// 显示进程的详细信息
$ ps -l
~~~~

| PID    | PPID     | TTY            | STAT                                                         | NI         |
| ------ | -------- | -------------- | ------------------------------------------------------------ | ---------- |
| 进程号 | 父进程号 | 进程启动的终端 | 进程当前的状态(S:休眠 , D:不可中断的休眠状态, R正在运行, Z: 僵死状态 , T 停止) | 进程优先级 |

| TIME                            | CMD          | USER   |
| ------------------------------- | ------------ | ------ |
| 进程自启动以来占用的CPU的总时间 | 进程的命令名 | 用户名 |



* 单独使用ps命令

  ~~~shell
  // 默认的ps命令, 只显示当前的的登陆用户(有控制终端)的进程的信息
  $ps -l
  // -l : 长格式显示 (详细的)
  // -w : 宽格式显示 (简略的)
  ~~~

* -a 选项

 ~~~shell
// 显示所有登陆用户的(有控制终端)进程的信息
$ ps -al 
 ~~~



* -x 选项

~~~shell
// 显示没有控制终端的进程的信息(系统进程)
$ ps -xl
~~~



* -e 选项

~~~shell
// 显示所有进程的信息(包括有控制终端 & 没有控制终端)
$ps -el
// OR 都是显示所有进程的信息
$ps -aux | more (MAC 下无效)
~~~



* -u 选项

~~~shell
//以长格式的方式显示所有隶属于ark的进程的信息
$ ps -u ark -l 
~~~



* 利用管道查看指定进程的信息

~~~shell
ps -l | grep httpd
~~~



* 根据某项进行排序显示

~~~shell
//根据pid进行升序的查看
$ ps -aux --sort pid
~~~



* 显示所有进程的**树状结构**(mac 上无效)

~~~shell
$ pstree -p
~~~





#### Kill命令 关闭进程

kill -l 可以看到所有**信号**的详情(1-31)

* 关闭进程 : kill 进程号   && 	pkill 进程名称

~~~shell
// 1234为进程的PID
// 寻找某个进程的PID可以利用命令e.g.
ps -el | grep process_name
$kill 1234
~~~

**直接关闭一些的进程的父进程则可以做到直接关闭这些进程, 而不用一个一个去关闭**

* 强行关闭进程 : kill -9 进程号
* 重新启动进程 : kill -1 进程号

* 关闭所有Process_name的进程 : killall Process_name

#### nice 和 renice 命令 , 改变进程优先级

* nice 

  **指定程序的优先级(默认的缺省进程的优先级为0)(优先级的范围为-20-19)**

  在启动服务的时候就制定优先级





















